!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n),n}:e(jQuery)}(function(e){"use strict";e.extend(e.FE.DEFAULTS,{lineBreakerTags:["table","hr","form","dl","span.fr-video"],lineBreakerOffset:15}),e.FE.PLUGINS.lineBreaker=function(t){function n(n,i){var o,a,r,s,l,d,c,u;if(null==n)s=i.parent(),l=s.offset().top,c=i.offset().top,o=c-Math.min((c-l)/2,t.opts.lineBreakerOffset),r=s.outerWidth(),a=s.offset().left;else if(null==i)s=n.parent(),d=s.offset().top+s.outerHeight(),u=n.offset().top+n.outerHeight(),o=u+Math.min((d-u)/2,t.opts.lineBreakerOffset),r=s.outerWidth(),a=s.offset().left;else{s=n.parent();var f=n.offset().top+n.height(),p=i.offset().top;if(f>p)return!1;o=(f+p)/2,r=s.outerWidth(),a=s.offset().left}t.opts.iframe&&(a+=t.$iframe.offset().left-e(t.o_win).scrollLeft(),o+=t.$iframe.offset().top-e(t.o_win).scrollTop()),t.$box.append(h),h.css("top",o-t.win.pageYOffset),h.css("left",a-t.win.pageXOffset),h.css("width",r),h.data("tag1",n),h.data("tag2",i),h.addClass("fr-visible").data("instance",t)}function i(e,i){var a,r,s=e.offset().top,l=e.offset().top+e.outerHeight();if(Math.abs(l-i)<=t.opts.lineBreakerOffset||Math.abs(i-s)<=t.opts.lineBreakerOffset)if(Math.abs(l-i)<Math.abs(i-s)){r=e.get(0);for(var d=r.nextSibling;d&&d.nodeType==Node.TEXT_NODE&&0===d.textContent.length;)d=d.nextSibling;if(!d)return n(e,null),!0;if(a=o(d))return n(e,a),!0}else{if(r=e.get(0),!r.previousSibling)return n(null,e),!0;if(a=o(r.previousSibling))return n(a,e),!0}h.removeClass("fr-visible").removeData("instance")}function o(n){if(n){var i=e(n);if(0===t.$el.find(i).length)return null;if(n.nodeType!=Node.TEXT_NODE&&i.is(t.opts.lineBreakerTags.join(",")))return i;if(i.parents(t.opts.lineBreakerTags.join(",")).length>0)return n=i.parents(t.opts.lineBreakerTags.join(",")).get(0),e(n)}return null}function a(n){m=null;var a,r,s,l=null,d=t.doc.elementFromPoint(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset);if(d&&("HTML"==d.tagName||"BODY"==d.tagName||t.node.isElement(d)))for(a=1;a<=t.opts.lineBreakerOffset;a++){if(r=t.doc.elementFromPoint(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset-a),r&&!t.node.isElement(r)&&r!=t.$wp.get(0)&&e(r).parents(t.$wp).length){l=o(r);break}if(s=t.doc.elementFromPoint(n.pageX-t.win.pageXOffset,n.pageY-t.win.pageYOffset+a),s&&!t.node.isElement(s)&&s!=t.$wp.get(0)&&e(s).parents(t.$wp).length){l=o(s);break}}else l=o(d);l?i(l,n.pageY):t.core.sameInstance(h)&&h.removeClass("fr-visible").removeData("instance")}function r(e){return!(h.hasClass("fr-visible")&&!t.core.sameInstance(h))&&(t.popups.areVisible()||t.$el.get(0).querySelectorAll(".fr-selected-cell").length?(h.removeClass("fr-visible"),!0):void(p===!1&&(m&&clearTimeout(m),m=setTimeout(a,30,e))))}function s(){m&&clearTimeout(m),h.hasClass("fr-visible")&&h.removeClass("fr-visible").removeData("instance")}function l(){p=!0,s()}function d(){p=!1}function c(n){if(!t.core.sameInstance(h))return!0;n.preventDefault(),h.removeClass("fr-visible").removeData("instance");var i=h.data("tag1"),o=h.data("tag2"),a=t.html.defaultTag();null==i?a&&"TD"!=o.parent().get(0).tagName?o.before("<"+a+">"+e.FE.MARKERS+"<br></"+a+">"):o.before(e.FE.MARKERS+"<br>"):a&&"TD"!=i.parent().get(0).tagName&&0===i.parents(a).length?i.after("<"+a+">"+e.FE.MARKERS+"<br></"+a+">"):i.after(e.FE.MARKERS+"<br>"),t.selection.restore()}function u(){t.shared.$line_breaker||(t.shared.$line_breaker=e('<div class="fr-line-breaker"><a class="fr-floating-btn" role="button" tabindex="-1" title="'+t.language.translate("Break")+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><rect x="21" y="11" width="2" height="8"/><rect x="14" y="17" width="7" height="2"/><path d="M14.000,14.000 L14.000,22.013 L9.000,18.031 L14.000,14.000 Z"/></svg></a></div>')),h=t.shared.$line_breaker,t.events.on("shared.destroy",function(){h.html("").removeData().remove(),h=null},!0),t.events.on("destroy",function(){h.removeData("instance").removeClass("fr-visible").appendTo("body"),clearTimeout(m)},!0),t.events.$on(h,"mouseleave",s,!0),t.events.$on(h,"mousemove",function(e){e.stopPropagation()},!0),t.events.$on(h,"mousedown","a",function(e){e.stopPropagation()},!0),t.events.$on(h,"click","a",c,!0)}function f(){return!!t.$wp&&(u(),p=!1,t.events.$on(t.$win,"mousemove",r),t.events.$on(e(t.win),"scroll",s),t.events.on("popups.show.table.edit",s),t.events.$on(e(t.win),"mousedown",l),void t.events.$on(e(t.win),"mouseup",d))}var h,p,m;return{_init:f}}});