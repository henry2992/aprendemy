.application-wrapper.container-fluid
  .row
    =render 'layouts/user_sidebar'
    .main-bg
      %content
        .content-wrapper.col-sm-9.col-md-10
          .application-content
            .content-margin.row
              %ol.breadcrumb{:style=>"background-color:#fff"}
                = render_breadcrumbs :tag => :li, :separator => ""
        .content-wrapper.col-sm-9.col-md-10
          .application-content
            .content-margin.row
              .app-text-holder.row.main-bg
                %content
                  %h1= @resource.generic_name
        .content-wrapper.col-sm-9.col-md-10
          .application-content
            .content-margin.row
              .app-text-holder.row.main-bg
                %content
                  - case @resource.material_type
                    - when "Video"
                      %h2.lead= @resource.material.description
                      %br
                      -var = @resource.material.url[-11,11]
                      %div{:id=>"video-placeholder"}
                    - when "Blog"
                      %p.lead= @resource.material.title
                      = @resource.material.content.html_safe
                    - when "Task"
                      %p.lead= @resource.material.title
                      %p= @resource.material.description
                      - if @resource.material.questions
                        / TODO: Definir la ruta que va a procesar el formulario
                        = form_tag(root_path) do
                          - @resource.material.questions.each do |q|
                            %h3= q.content
                            - if q.picture.present?
                              = image_tag(q.picture, class: "img-responsive", alt: q.content)
                            - if q.explanation
                              %p.lead
                                = q.explanation
                            - if q.url
                              = link_to q.url, q.url
                            - if q.questions
                              - q.questions.each do |qs|
                                %hr{:style=>"width:80%"}
                                %h3= qr.content
                                - if qr.picture.present?
                                  = image_tag(qr.picture, class: "img-responsive", alt: qr.content)
                                - if qr.explanation
                                  %p.lead
                                    = qr.explanation
                                - if qr.url
                                  = link_to qr.url, qr.url
                            - if q.choices
                              - q.choices.each do |c|
                                %p
                                  = radio_button_tag "question[#{q.id}]", c.id
                                  = c.content
                            %hr
                          = button_tag 'Terminar Tarea' , class: 'btn btn-primary' , type: :submit
- if @resource.material_type == "Video"
  %script{:src=>"http://www.youtube.com/iframe_api"}
  :javascript
    console.log("#{@resource.material_type}");
    var player,
      time_update_interval = 0;

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('video-placeholder', {
            width: 600,
            height: 400,
            videoId: '#{var}',
            playerVars: {
                color: 'white'
            },
            events: {
                onStateChange: finished
            }
        });
    }
    
    function finished(event)
    {
      if (event.data == 0){
        alert("finished");
      }
    }

